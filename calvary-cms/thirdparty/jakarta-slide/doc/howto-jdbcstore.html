<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Jakarta Slide - JDBC Store Howto</title>
<meta value="Remy Maucherat" name="author">
<meta value="remm@apache.org" name="email">
</head>
<body vlink="#525D76" alink="#525D76" link="#525D76" text="#000000" bgcolor="#ffffff">
<table cellspacing="4" width="100%" border="0">
<!--PAGE HEADER-->
<tr>
<td colspan="2">
<!--JAKARTA LOGO--><a href="http://jakarta.apache.org/"><img border="0" alt="The Jakarta Project" align="left" src="./images/jakarta-logo.gif"></a>
<!--PROJECT LOGO--><a href="http://jakarta.apache.org/slide/"><img border="0" alt="The Jakarta Slide Project" align="right" src="./images/Slide.gif"></a></td>
</tr>
<!--HEADER SEPARATOR-->
<tr>
<td colspan="2">
<hr size="1" noshade="">
</td>
</tr>
<tr>
<!--LEFT SIDE NAVIGATION-->
<td nowrap="true" valign="top" width="20%">
<p>
<strong>Main</strong>
</p>
<ul>
<li>
<a href="index.html">Introduction</a>
</li>
<li>
<a href="news.html">News</a>
</li>
<li>
<a href="http://jakarta.apache.org/site/binindex.html">Downloads</a>
</li>
<li>
<a href="status.html">Status</a>
</li>
<li>
<a href="changelog.html">Changelog</a>
</li>
<li>
<a href="contrib.html">Contributors</a>
</li>
</ul>
<p>
<strong>Resources</strong>
</p>
<ul>
<li>
<a href="http://faq.globalvision.com.au/">FAQ</a>
</li>
<li>
<a href="http://jakarta.apache.org/site/mail.html">Mailing Lists</a>
</li>
<li>
<a href="http://jakarta.apache.org/builds/gump/latest/jakarta-slide.html">Build Status</a>
</li>
<li>
<a href="http://jakarta.apache.org/site/cvsindex.html">CVS</a>
</li>
<li>
<a href="library.html">Library</a>
</li>
</ul>
<p>
<strong>User's Guide</strong>
</p>
<ul>
<li>
<a href="server.html">Server</a>
</li>
<li>
<a href="webdav-client.html">Client</a>
</li>
</ul>
<p>
<strong>Administrator's Guide</strong>
</p>
<ul>
<li>
<a href="installation.html">Installation</a>
</li>
<li>
<a href="conf-lib.html">Configuration</a>
</li>
</ul>
<p>
<strong>HOW-TOs</strong>
</p>
<ul>
<li>
<a href="howto-tomcat.html">Tomcat Howto</a>
</li>
<li>
<a href="howto-jdbcstore.html">JDBC Stores Howto</a>
</li>
<li>
<a href="howto-j2eestore.html">J2EE Stores Howto</a>
</li>
</ul>
<p>
<strong>Programmer's Corner</strong>
</p>
<ul>
<li>
<a href="architecture.html">Architecture</a>
</li>
<li>
<a href="domain.html">Domain</a>
</li>
<li>
<a href="namespace.html">Namespace</a>
</li>
<li>
<a href="examples.html">Examples</a>
</li>
</ul>
<p>
<strong>Slide API</strong>
</p>
<ul>
<li>
<a href="structure.html">Structure</a>
</li>
<li>
<a href="security.html">Security</a>
</li>
<li>
<a href="lock.html">Lock</a>
</li>
<li>
<a href="version.html">Content</a>
</li>
<li>
<a href="macro.html">Macro</a>
</li>
<li>
<a href="search.html">Index</a>
</li>
<li>
<a href="process.html">Process</a>
</li>
</ul>
<p>
<strong>Reference</strong>
</p>
<ul>
<li>
<a href="uml/index.html">UML</a>
</li>
<li>
<a href="javadoc/index.html">JavaDoc</a>
</li>
<li>
<a href="clientjavadoc/index.html">WebDAV Client Javadoc</a>
</li>
<li>
<a href="jstl-taglib.html">Tag Library (JSTL)</a>
</li>
<li>
<a href="struts-taglib.html">Tag Library (Struts)</a>
</li>
</ul>
</td>
<!--RIGHT SIDE MAIN BODY--><td align="left" valign="top" width="80%">
<body>
  
  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#525D76"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Initialization"><strong>Initialization</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
    
<p>
      On the first startup of the Store, it will attempt to automatically
      create the appropriate tables in the database. The creation will fail
      if any of the types used is not supported by the user's database, in 
      which case the tables have to be created before starting the store.
    </p>
    
    
<p>
      This document includes a number of SQL scripts which can be used with 
      various databases to create the tables. Contributions are welcome :)
    </p>
    
    
<p>
      Note: The JDBC store's goal is to be as compatible as possible.
      Specific, high performance stores will eventually be developed, based
      around some vendor XA driver.
    </p>
    
  
</blockquote>
</td>
</tr>
</table>
  
  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#525D76"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Tables"><strong>Tables</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
<p>
      This section presents the database schema which is used by the JDBC 
      stores. The types mentioned are the Java types which are expected for 
      each field.
    </p>
<table width="100%">
<tr>
<td width="45%" valign="top">
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Objects"><strong>Objects</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>classname: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Children"><strong>Children</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>childuri: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Links"><strong>Links</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>link: String</li>
        
<li>linkto: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Permissions"><strong>Permissions</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>object: String</li>
        
<li>revisionnumber: String</li>
        
<li>subject: String</li>
        
<li>action: String</li>
        
<li>inheritable: int</li>
        
<li>negative: int</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Locks"><strong>Locks</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>id: String</li>
        
<li>object: String</li>
        
<li>subject: String</li>
        
<li>type: String</li>
        
<li>expirationdate: String</li>
        
<li>inheritable: int</li>
        
<li>xexclusive: int</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Revisions"><strong>Revisions</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>isversioned: int</li>
        
<li>initialrevision: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Workingrevision"><strong>Workingrevision</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>baserevision: String</li>
        
<li>xnumber: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
</td><td width="10%" valign="top">&nbsp;</td><td width="*" valign="top">
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Latestrevisions"><strong>Latestrevisions</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>branchname: String</li>
        
<li>xnumber: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Branches"><strong>Branches</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>xnumber: String</li>
        
<li>childnumber: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Revision"><strong>Revision</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>xnumber: String</li>
        
<li>branchname: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Label"><strong>Label</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>xnumber: String</li>
        
<li>label: String</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Property"><strong>Property</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>xnumber: String</li>
        
<li>name: String</li>
        
<li>value: String</li>
        
<li>namespace: String</li>
        
<li>type: String</li>
        
<li>protected: int</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Revisioncontent"><strong>Revisioncontent</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
      
      
<ul>
        
<li>uri: String</li>
        
<li>xnumber: String</li>
        
<li>content: byte[]</li>
      
</ul>
      
    
</blockquote>
</td>
</tr>
</table>
</td>
</tr>
</table>
</blockquote>
</td>
</tr>
</table>

  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#525D76"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Database creation scripts"><strong>Database creation scripts</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>  
    
<p>
      The initialization script for Hypersonic SQL is the one which is run at the 
      startup of the default JDBC store.
    </p>

    
<table>
<th><td>Supported databases:</td></th>
<tr>
<td>
<ul>
<li>
<a href="#Hypersonic SQL">Hypersonic SQL</a>
</li>
<li>
<a href="#mySQL">mySQL</a>
</li>
<li>
<a href="#PostgreSQL">PostgreSQL</a>
</li>
<li>
<a href="#Oracle 8i">Oracle 8i</a>
</li>
<li>
<a href="#Cloudscape">Cloudscape</a>
</li>
<li>
<a href="#Microsoft SQL Server">Microsoft SQL Server</a>
</li>
</ul>
</td>
</tr>
</table>
<br>

  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Hypersonic SQL"><strong>Hypersonic SQL</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
    
<p>

<pre>
create table objects(uri varchar(65536) primary key, classname varchar(4096);

create table children(uri varchar(65536), childuri varchar(65536));

create table links(link varchar(65536), linkto varchar(65536));

create table permissions(object varchar(65536), revisionnumber varchar(20), 
  subject varchar(65536), action varchar(65536), inheritable int, 
  negative int);

create table locks(id varchar(65536), object varchar(4096), 
  subject varchar(4096), type varchar(4096), 
  expirationdate varchar(15), inheritable int, xexclusive int);

create table revisions(uri varchar(65536) primary key, 
  isversioned int, initialrevision varchar(10));

create table workingrevision(uri varchar(65536), 
  baserevision varchar(20), xnumber varchar(20));

create table latestrevisions(uri varchar(65536), 
  branchname varchar(4096), xnumber varchar(20));

create table branches(uri varchar(65536), xnumber varchar(20), 
  childnumber varchar(20));

create table revision(uri varchar(65536), xnumber varchar(20), 
  branchname varchar(4096));

create table label(uri varchar(65536), xnumber varchar(20), 
  label varchar(4096));

create table property(uri varchar(65536), xnumber varchar(20), 
  name varchar(4096), value varchar(65536), namespace varchar(4096), 
  type varchar(100), protected int);

create table revisioncontent(uri varchar(65536), xnumber varchar(20), 
  content longvarbinary);
</pre>
    
</p>
    
  
</blockquote>
</td>
</tr>
</table>
  
  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="mySQL"><strong>mySQL</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
    
<p>

<pre>
create database myDB;

use myDB;

create table objects(uri blob not null, primary key uriIndex (uri(255)), 
  classname blob);

create table children(uri blob, childuri blob);

create table links(link blob, linkto blob);

create table permissions(object blob, revisionnumber varchar(20), 
  subject blob, action blob, inheritable int, negative int);

create table locks(id blob, object blob, subject blob, type blob, 
  expirationdate varchar(15), inheritable int, xexclusive int);

create table revisions(uri blob not null, primary key uriIndex 
  (uri(255)), isversioned int, initialrevision varchar(10) );

create table workingrevision(uri blob, baserevision varchar(20), xnumber 
  varchar(20) );

create table latestrevisions(uri blob, branchname blob, xnumber 
  varchar(20) );

create table branches(uri blob, xnumber varchar(20), childnumber 
  varchar(20) );

create table revision(uri blob, xnumber varchar(20), branchname blob);

create table label(uri blob, xnumber varchar(20), label blob);

create table property(uri blob, xnumber varchar(20), name blob, value 
  blob, namespace blob, type varchar(100), protected int);

create table revisioncontent(uri blob, xnumber varchar(20), content blob);
</pre>
    
</p>
    
  
</blockquote>
</td>
</tr>
</table>

  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="PostgreSQL"><strong>PostgreSQL</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
    
<p>

<pre>
create table objects(uri varchar(3200) primary key, classname varchar(4000));

create table children(uri varchar(4000), childuri varchar(4000));

create table links(link varchar(4000), linkto varchar(4000));

create table permissions(object varchar(4000), revisionnumber varchar(20), 
  subject varchar(4000), action varchar(4000), inheritable int, negative int);

create table locks(id varchar(4000), object varchar(4000), 
  subject varchar(4000), type varchar(4000), 
  expirationdate varchar(15), inheritable int, xexclusive int);

create table revisions(uri varchar(3200) primary key, 
  isversioned int, initialrevision varchar(10));

create table workingrevision(uri varchar(4000), 
  baserevision varchar(20), xnumber varchar(20));

create table latestrevisions(uri varchar(4000), 
  branchname varchar(4000), xnumber varchar(20));

create table branches(uri varchar(4000), xnumber varchar(20), 
  childnumber varchar(20));

create table revision(uri varchar(4000), xnumber varchar(20), 
  branchname varchar(4000));

create table label(uri varchar(4000), xnumber varchar(20), 
  label varchar(4000));

create table property(uri varchar(4000), xnumber varchar(20), 
  name varchar(4000), value varchar(4000), namespace varchar(4000), 
  type varchar(100), protected int);

create table revisioncontent(uri varchar(4000), xnumber varchar(20), 
  content oid);

</pre>
    
</p>
    
  
</blockquote>
</td>
</tr>
</table>
  
  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Oracle 8i"><strong>Oracle 8i</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
    
<p>

<pre>
create table objects(uri varchar(3200) primary key, classname varchar(4000));

create table children(uri varchar(4000), childuri varchar(4000));

create table links(link varchar(4000), linkto varchar(4000));

create table permissions(object varchar(4000), revisionnumber varchar(20), 
  subject varchar(4000), action varchar(4000), inheritable int, negative int);

create table locks(id varchar(4000), object varchar(4000), 
  subject varchar(4000), type varchar(4000), 
  expirationdate varchar(15), inheritable int, xexclusive int);

create table revisions(uri varchar(3200) primary key, 
  isversioned int, initialrevision varchar(10));

create table workingrevision(uri varchar(4000), 
  baserevision varchar(20), xnumber varchar(20));

create table latestrevisions(uri varchar(4000), 
  branchname varchar(4000), xnumber varchar(20));

create table branches(uri varchar(4000), xnumber varchar(20), 
  childnumber varchar(20));

create table revision(uri varchar(4000), xnumber varchar(20), 
  branchname varchar(4000));

create table label(uri varchar(4000), xnumber varchar(20), 
  label varchar(4000));

create table property(uri varchar(4000), xnumber varchar(20), 
  name varchar(4000), value varchar(4000), namespace varchar(4000), 
  type varchar(100), protected int);

create table revisioncontent(uri varchar(4000), xnumber varchar(20), 
  content blob);
</pre>
    
</p>
    
  
</blockquote>
</td>
</tr>
</table>
  
  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Cloudscape"><strong>Cloudscape</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
    
<p>

<pre>
create table objects(uri varchar(3200) primary key, classname varchar(4000));

create table children(uri varchar(4000), childuri varchar(4000));

create table links(link varchar(4000), linkto varchar(4000));

create table permissions(object varchar(4000), revisionnumber varchar(20), 
  subject varchar(4000), "ACTION" varchar(4000), inheritable int, negative int);

create table locks(id varchar(4000), object varchar(4000), 
  subject varchar(4000), type varchar(4000), 
  expirationdate varchar(15), inheritable int, xexclusive int);

create table revisions(uri varchar(3200) primary key, 
  isversioned int, initialrevision varchar(10));

create table workingrevision(uri varchar(4000), 
  baserevision varchar(20), xnumber varchar(20));

create table latestrevisions(uri varchar(4000), 
  branchname varchar(4000), xnumber varchar(20));

create table branches(uri varchar(4000), xnumber varchar(20), 
  childnumber varchar(20));

create table revision(uri varchar(4000), xnumber varchar(20), 
  branchname varchar(4000));

create table label(uri varchar(4000), xnumber varchar(20), 
  label varchar(4000));

create table property(uri varchar(4000), xnumber varchar(20), 
  name varchar(4000), value varchar(4000), namespace varchar(4000), 
  type varchar(100), protected int);

create table revisioncontent(uri varchar(4000), xnumber varchar(20), 
  content long varbinary);
</pre>
    
</p>
    
  
</blockquote>
</td>
</tr>
</table>
  
  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#828DA6"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Microsoft SQL Server"><strong>Microsoft SQL Server</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
    
<p>

<pre>
EXEC sp_addtype N'uri', N'varchar (800)', N'not null'

create table objects(uri uri primary key, classname text);

create table children(uri uri, childuri uri);

create table links(link uri, linkto uri);

create table permissions(object uri, revisionnumber varchar(20), 
  subject uri, action uri, inheritable int, negative int);

create table locks(id uri, object uri, subject uri, type uri, 
  expirationdate varchar(15), inheritable int, xexclusive int);

create table revisions(uri uri primary key, 
  isversioned int, initialrevision varchar(10) );

create table workingrevision(uri uri, baserevision varchar(20), 
  xnumber varchar(20) );

create table latestrevisions(uri uri, branchname text, 
  xnumber varchar(20) );

create table branches(uri uri, xnumber varchar(20), 
  childnumber varchar(20) );

create table revision(uri uri, xnumber varchar(20), branchname text);

create table label(uri uri, xnumber varchar(20), label text);

create table property(uri uri, xnumber varchar(20), name text, value 
  text, namespace text, type varchar(100), protected int);

create table revisioncontent(uri uri, xnumber varchar(20), content image);
</pre>
    
</p>
    
  
</blockquote>
</td>
</tr>
</table>
  
</blockquote>
</td>
</tr>
</table>


</body>
</td>
</tr>
<!--FOOTER SEPARATOR-->
<tr>
<td colspan="2">
<hr size="1" noshade="">
</td>
</tr>
<!--PAGE FOOTER-->
<tr>
<td colspan="2">
<div align="center">
<font size="-1" color="#525D76"><em>
        Copyright &copy; 1999-2001, Apache Software Foundation
        </em></font>
</div>
</td>
</tr>
</table>
</body>
</html>
