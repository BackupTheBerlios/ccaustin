<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Jakarta Slide - J2EE Store Howto</title>
<meta value="Colin Britton" name="author">
<meta value="cbritton@metatomix.com" name="email">
</head>
<body vlink="#525D76" alink="#525D76" link="#525D76" text="#000000" bgcolor="#ffffff">
<table cellspacing="4" width="100%" border="0">
<!--PAGE HEADER-->
<tr>
<td colspan="2">
<!--JAKARTA LOGO--><a href="http://jakarta.apache.org/"><img border="0" alt="The Jakarta Project" align="left" src="./images/jakarta-logo.gif"></a>
<!--PROJECT LOGO--><a href="http://jakarta.apache.org/slide/"><img border="0" alt="The Jakarta Slide Project" align="right" src="./images/Slide.gif"></a></td>
</tr>
<!--HEADER SEPARATOR-->
<tr>
<td colspan="2">
<hr size="1" noshade="">
</td>
</tr>
<tr>
<!--LEFT SIDE NAVIGATION-->
<td nowrap="true" valign="top" width="20%">
<p>
<strong>Main</strong>
</p>
<ul>
<li>
<a href="index.html">Introduction</a>
</li>
<li>
<a href="news.html">News</a>
</li>
<li>
<a href="http://jakarta.apache.org/site/binindex.html">Downloads</a>
</li>
<li>
<a href="status.html">Status</a>
</li>
<li>
<a href="changelog.html">Changelog</a>
</li>
<li>
<a href="contrib.html">Contributors</a>
</li>
</ul>
<p>
<strong>Resources</strong>
</p>
<ul>
<li>
<a href="http://faq.globalvision.com.au/">FAQ</a>
</li>
<li>
<a href="http://jakarta.apache.org/site/mail.html">Mailing Lists</a>
</li>
<li>
<a href="http://jakarta.apache.org/builds/gump/latest/jakarta-slide.html">Build Status</a>
</li>
<li>
<a href="http://jakarta.apache.org/site/cvsindex.html">CVS</a>
</li>
<li>
<a href="library.html">Library</a>
</li>
</ul>
<p>
<strong>User's Guide</strong>
</p>
<ul>
<li>
<a href="server.html">Server</a>
</li>
<li>
<a href="webdav-client.html">Client</a>
</li>
</ul>
<p>
<strong>Administrator's Guide</strong>
</p>
<ul>
<li>
<a href="installation.html">Installation</a>
</li>
<li>
<a href="conf-lib.html">Configuration</a>
</li>
</ul>
<p>
<strong>HOW-TOs</strong>
</p>
<ul>
<li>
<a href="howto-tomcat.html">Tomcat Howto</a>
</li>
<li>
<a href="howto-jdbcstore.html">JDBC Stores Howto</a>
</li>
<li>
<a href="howto-j2eestore.html">J2EE Stores Howto</a>
</li>
</ul>
<p>
<strong>Programmer's Corner</strong>
</p>
<ul>
<li>
<a href="architecture.html">Architecture</a>
</li>
<li>
<a href="domain.html">Domain</a>
</li>
<li>
<a href="namespace.html">Namespace</a>
</li>
<li>
<a href="examples.html">Examples</a>
</li>
</ul>
<p>
<strong>Slide API</strong>
</p>
<ul>
<li>
<a href="structure.html">Structure</a>
</li>
<li>
<a href="security.html">Security</a>
</li>
<li>
<a href="lock.html">Lock</a>
</li>
<li>
<a href="version.html">Content</a>
</li>
<li>
<a href="macro.html">Macro</a>
</li>
<li>
<a href="search.html">Index</a>
</li>
<li>
<a href="process.html">Process</a>
</li>
</ul>
<p>
<strong>Reference</strong>
</p>
<ul>
<li>
<a href="uml/index.html">UML</a>
</li>
<li>
<a href="javadoc/index.html">JavaDoc</a>
</li>
<li>
<a href="clientjavadoc/index.html">WebDAV Client Javadoc</a>
</li>
<li>
<a href="jstl-taglib.html">Tag Library (JSTL)</a>
</li>
<li>
<a href="struts-taglib.html">Tag Library (Struts)</a>
</li>
</ul>
</td>
<!--RIGHT SIDE MAIN BODY--><td align="left" valign="top" width="80%">
<body>
  
  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#525D76"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Building the store"><strong>Building the store</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
<p>In order to use the J2EE stores you need to build Jakarta-Slide with the Datasource 
    classes available.
    They are included in JDK1.4 but earlier versions require an additional library 
    (jdbc2_0-stdext.jar) in the slide lib directory. </p>
  
</blockquote>
</td>
</tr>
</table>

  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#525D76"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Configuring Slide"><strong>Configuring Slide</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
<p>In order to use the stores, the Domain.xml file needs to contain the following configuration for the store:
<pre>
&lt;definition&gt;
    &lt;store name="j2ee"&gt;
        &lt;nodestore classname="slidestore.j2ee.J2EEDescriptorsStore"&gt;
            &lt;parameter name="datasource"&gt;jdbc/mtx&lt;/parameter&gt;
        &lt;/nodestore&gt;
        &lt;securitystore&gt;
            &lt;reference store="nodestore"/&gt;
        &lt;/securitystore&gt;
        &lt;lockstore&gt;
            &lt;reference store="nodestore"/&gt;
        &lt;/lockstore&gt;
        &lt;revisiondescriptorsstore&gt;
            &lt;reference store="nodestore"/&gt;
        &lt;/revisiondescriptorsstore&gt;
        &lt;revisiondescriptorstore&gt;
            &lt;reference store="nodestore"/&gt;
        &lt;/revisiondescriptorstore&gt;
        &lt;contentstore classname="slidestore.j2ee.J2EEContentStore"&gt;
            &lt;parameter name="datasource"&gt;jdbc/mtx&lt;/parameter&gt;
        &lt;/contentstore&gt;
    &lt;/store&gt;
    &lt;scope match="/" store="j2ee"/&gt;
&lt;/definition&gt;
</pre>
  
</p>
  
</blockquote>
</td>
</tr>
</table>

  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#525D76"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Configuring Tomcat 4.x"><strong>Configuring Tomcat 4.x</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
    
<p>In order to use this with Tomcat you need to setup the datasource. 
    Instructions for this are at 
    <a href="http://jakarta.apache.org/tomcat/tomcat-4.0-doc/jndi-resources-howto.html">
    http://jakarta.apache.org/tomcat/tomcat-4.0-doc/jndi-resources-howto.html</a>.
    </p>
    
<p>If you follow the above instructions you will make changes similar to the 
    following in web.xml and server.xml.</p>

<p>

<pre>
web.xml
&lt;resource-ref&gt;
    &lt;description&gt;Testing Tomcat-wide datasource usage&lt;/description&gt;
    &lt;res-ref-name&gt;jdbc/mtx&lt;/res-ref-name&gt;
    &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;
    &lt;res-auth&gt;Container&lt;/res-auth&gt;
&lt;/resource-ref&gt;

server.xml
&lt;DefaultContext debug="99"&gt;
    &lt;Resource name="jdbc/mtx" auth="Container" type="javax.sql.DataSource"/&gt;
    &lt;ResourceParams name="jdbc/mtx"&gt;
        &lt;parameter&gt;
            &lt;name&gt;user&lt;/name&gt;
            &lt;value&gt;bar&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;password&lt;/name&gt;
            &lt;value&gt;foo&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;driverClassName&lt;/name&gt;
            &lt;value&gt;org.hsqldb.jdbcDriver&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;driverName&lt;/name&gt;
            &lt;value&gt;jdbc:hsqldb:slide&lt;/value&gt;
        &lt;/parameter&gt;
    &lt;/ResourceParams&gt;
&lt;/DefaultContext&gt;
</pre>

</p>
  
</blockquote>
</td>
</tr>
</table>

  
<table width="100%" cellpadding="2" cellspacing="0" border="0">
<tr>
<td bgcolor="#525D76"><font face="arial,helvetica.sanserif" color="#ffffff"><a name="Troubleshooting"><strong>Troubleshooting</strong></a></font></td>
</tr>
<tr>
<td>
<blockquote>
  
<p>A couple of general notes in case you encounter problems.</p>

  
<p>It is important that the only jndi.jar, naming.jar and jdbc.jar's and 
  your jdbc driver are in the %CATALINA_HOME%/common/libs and/or %CATALINA_HOME%/libs folders.</p>

  
<p>If slide loads any of the classes from its own classloder it will either 
  not find the tomcat datasource or it will fail to load the DB drivers.</p>

  
<p>With Tomcat 4.0.1 the standard implementation provides a datasource which 
  has pooling. It has no configured limits, it will grow as required and lazily 
  shrinks to reduce its size. Tomcat also has the capability to support 
  other datasource implementations and will offer one based on the 
  Apache commons DBCP pool implementation in version 4.1.</p>
  
</blockquote>
</td>
</tr>
</table>


</body>
</td>
</tr>
<!--FOOTER SEPARATOR-->
<tr>
<td colspan="2">
<hr size="1" noshade="">
</td>
</tr>
<!--PAGE FOOTER-->
<tr>
<td colspan="2">
<div align="center">
<font size="-1" color="#525D76"><em>
        Copyright &copy; 1999-2001, Apache Software Foundation
        </em></font>
</div>
</td>
</tr>
</table>
</body>
</html>
