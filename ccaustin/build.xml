<?xml version="1.0"?>
<!-- ===================================================================== -->
<!-- Build File for ANT (http://jakarta.apache.org/ant                     -->
<!-- ===================================================================== -->
<project name="calvary" default="web" basedir=".">
	<!-- Global Settings -->
	<property name="Name" value="Calvary Chapel Austin"/>
	<property name="name" value="calvary"/>
	<property name="version" value="2.0"/>
	<property name="home" value="."/>
	<property name="src.dir" value="${home}/src"/>
	<property name="src.web.dir" value="${src.dir}/web"/>
	<property name="src.xml.dir" value="${src.web.dir}/xml"/>
	<property name="src.xsl.dir" value="${src.web.dir}/xsl"/>
	<property name="src.js.dir" value="${src.web.dir}/js"/>
	<property name="src.images.dir" value="${src.web.dir}/images"/>
	<property name="src.css.dir" value="${src.web.dir}/css"/>
	<property name="build.dir" value="${home}/build"/>
	<property name="build.web.dir" value="${build.dir}/docs"/>
	<!-- Give user a chance to override without editing this file 
       (and without typing -D each time it compiles it -->
	<property file="${home}/.ant.properties"/>
	<property file="${user.home}/.ant.properties"/>
	<!-- =================================================================== -->
	<!-- Clean Target                                                        -->
	<!-- =================================================================== -->
	<target name="clean" description="Removes all build and deploy output.">
		<echo message="...........Cleaning project directories..........."/>
		<delete dir="${build.dir}"/>
	</target>
	<!-- =================================================================== -->
	<!-- =================================================================== -->
	<!-- =================================================================== -->
	<!-- Check Options Target                                                -->
	<!-- =================================================================== -->
	<target name="checkoptions" description="Performs pre-processing checks for environment."/>
	
	<target name="validate-xml" description="Performs validation of all XML files">
	    <xmlvalidate failonerror="no" lenient="yes" warn="yes">
        <fileset dir="${src.xml.dir}" includes="**/*.xml"/>  
    </xmlvalidate>
	</target>
	<!-- =================================================================== -->
	<!-- =================================================================== -->
	<!-- =================================================================== -->
	<!-- Creates the web site                                                -->
	<!-- =================================================================== -->
	<target name="web" depends="checkoptions" description="Creates all HTML by calling web-xyz targets.">
		<mkdir dir="${build.web.dir}"/>
		<antcall target="web-about"/>
		<antcall target="web-calendar"/>
		<antcall target="web-messages"/>
		<antcall target="web-ministries"/>
		<antcall target="web-homepage"/>
		<antcall target="web-articles"/>
		<antcall target="web-news"/>
		<antcall target="copy-files"/>
	</target>
	
	<target name="copy-files">
		<copy todir="${build.web.dir}/images">
			<fileset dir="${src.images.dir}"/>
		</copy>
		<copy todir="${build.web.dir}/js">
			<fileset dir="${src.js.dir}"/>
		</copy>
		<copy todir="${build.web.dir}/css">
			<fileset dir="${src.css.dir}"/>
		</copy>
	</target>

	<!-- Creates the About section of the web site                         -->
	<target name="web-about" depends="checkoptions" description="Creates the 'About' section of the site.">
		<!-- style style="${src.xml.dir}/globalmenu.xsl" in="${src.xml.dir}/globalmenu.xml" out="${build.web.dir}/js/ca.js"/ -->
		<style force="yes" style="${src.xml.dir}/about/about.xsl" in="${src.xml.dir}/about/about.xml" out="${build.web.dir}/about/about.html"/>
		<style force="yes" style="${src.xml.dir}/about/beliefs.xsl" in="${src.xml.dir}/about/beliefs.xml" out="${build.web.dir}/about/beliefs.html"/>
		<style force="yes" style="${src.xml.dir}/about/history.xsl" in="${src.xml.dir}/about/history.xml" out="${build.web.dir}/about/history.html"/>
		<style force="yes" style="${src.xml.dir}/about/vision.xsl" in="${src.xml.dir}/about/vision.xml" out="${build.web.dir}/about/vision.html"/>
		<style force="yes" style="${src.xml.dir}/about/staff.xsl" in="${src.xml.dir}/about/staff.xml" out="${build.web.dir}/about/staff.html"/>
		<!-- style style="${src.xml.dir}/about/staff-detail.xsl" in="${src.xml.dir}/about/staff.xml" out="${build.web.dir}/about/staff-detail.html"/ -->
		<style force="yes" style="${src.xml.dir}/staff/allen.xsl" in="${src.xml.dir}/staff/allen.xml" out="${build.web.dir}/staff/allen.html"/>
	</target>
	<!-- Creates the Calendar/Events section of the web site                         -->
	<target name="web-calendar" depends="checkoptions" description="Creates the Calendar' section of the site.">
		<style force="yes" style="${src.xml.dir}/calendar/schedule.xsl" in="${src.xml.dir}/calendar/schedule.xml" out="${build.web.dir}/calendar/schedule.html"/>
		<style force="yes" style="${src.xml.dir}/calendar/events.xsl" in="${src.xml.dir}/calendar/events.xml" out="${build.web.dir}/calendar/events.html"/>
         </target>

        <!-- Creates the Tape/RealAudio section of the web site                         -->
	<target name="web-messages" depends="checkoptions" description="Creates the tape and RealAudio section of the site">
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Audio-BookStudies.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioBookStudies.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Audio-Overview.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioOverview.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Audio-TopicalSeries.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioTopicalSeries.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Audio-InDepth.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioInDepth.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Audio-Misc.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioMisc.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Audio-categories.xsl" in="${src.xml.dir}/msgs/msgs-categories.xml" out="${build.web.dir}/msgs/msgsAudioArchive.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Tapes-Overview.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesOverview.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Tapes-TopicalSeries.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesTopicalSeries.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Tapes-BookStudies.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesBookStudies.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Tapes-InDepth.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesInDepth.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Tapes-Misc.xsl" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesMisc.html"/> 
                <style force="yes" style="${src.xml.dir}/msgs/msgs-Tapes-categories.xsl" in="${src.xml.dir}/msgs/msgs-categories.xml" out="${build.web.dir}/msgs/msgsTapeArchive.html"/>
         </target>

        <!-- Creates the Ministry section of the web site                         -->
	<target name="web-ministries" depends="checkoptions" description="Creates the ministry section of the site">
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/ydc.xml" out="${build.web.dir}/ministries/ydc.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/focus.xml" out="${build.web.dir}/ministries/focus.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/frontline.xml" out="${build.web.dir}/ministries/frontline.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/home.xml" out="${build.web.dir}/ministries/home.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/men.xml" out="${build.web.dir}/ministries/men.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/women.xml" out="${build.web.dir}/ministries/women.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/worship.xml" out="${build.web.dir}/ministries/worship.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/youth.xml" out="${build.web.dir}/ministries/youth.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/dinner.xml" out="${build.web.dir}/ministries/dinner.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/media.xml" out="${build.web.dir}/ministries/media.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/greet.xml" out="${build.web.dir}/ministries/greet.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/meals.xml" out="${build.web.dir}/ministries/meals.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/newbelievers.xml" out="${build.web.dir}/ministries/newbelievers.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/prayer.xml" out="${build.web.dir}/ministries/prayer.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/prison.xml" out="${build.web.dir}/ministries/prison.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/sound.xml" out="${build.web.dir}/ministries/sound.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/usher.xml" out="${build.web.dir}/ministries/usher.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/youthcrisis.xml" out="${build.web.dir}/ministries/youthcrisis.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/internet.xml" out="${build.web.dir}/ministries/internet.html"/>          
        </target>

        <!-- Creates the Ministry section of the web site                         -->
	<target name="web-homepage" depends="checkoptions" description="Creates the homepage section of the site">
                <style force="yes" style="${src.xml.dir}/homepage/home.xsl" in="${src.xml.dir}/homepage/home.xml" out="${build.web.dir}/homepage/index.html"/> 
                <style force="yes" style="${src.xml.dir}/homepage/index.xsl" in="${src.xml.dir}/homepage/index.xml" out="${build.web.dir}/index.html"/> 
        </target>

        <!-- Creates the Articles section of the web site                         -->
	<target name="web-articles" depends="checkoptions" description="Creates the global articles for the site">
                <style force="yes" style="${src.xml.dir}/articles/articles.xsl" basedir="${src.xml.dir}/articles" destdir="${build.web.dir}/articles" includes="**/*.xml"/> 
        </target>

        <!-- Creates the Articles section of the web site                         -->
	<target name="web-news" depends="checkoptions" description="Creates the global news items for the site">
                <style force="yes" style="${src.xml.dir}/news/news.xsl" basedir="${src.xml.dir}/news" destdir="${build.web.dir}/news" includes="**/*.xml"/> 
        </target>

	<!-- =================================================================== -->
	<!-- =================================================================== -->
    <target name="deploy" depends="checkoptions" description="Deploys the docs to the deploy.dir location">
      <copy todir="${deploy.dir}">
	<fileset dir="${build.web.dir}"/>
       </copy>
    </target>

</project>
