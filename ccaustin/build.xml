<?xml version="1.0"?>
<!-- ===================================================================== -->
<!-- Build File for ANT (http://jakarta.apache.org/ant                     -->
<!-- ===================================================================== -->
<project name="calvary" default="web" basedir=".">
	<!-- Global Settings -->
	<property name="Name" value="Calvary Chapel Austin"/>
	<property name="name" value="calvary"/>
	<property name="version" value="2.0"/>
	<property name="home" value="."/>
	<property name="src.dir" value="${home}/src"/>
	<property name="src.web.dir" value="${src.dir}/web"/>
	<property name="src.xml.dir" value="${src.web.dir}/xml"/>
	<property name="src.xsl.dir" value="${src.web.dir}/xsl"/>
	<property name="src.js.dir" value="${src.web.dir}/js"/>
	<property name="src.images.dir" value="${src.web.dir}/images"/>
	<property name="src.css.dir" value="${src.web.dir}/css"/>
	<property name="build.dir" value="${home}/build"/>
	<property name="build.web.dir" value="${build.dir}/docs"/>
	<property name="build.tmpgen.dir" value="${build.dir}/_tmpgen"/>
	<property name="autogen.build.web" value="${src.xml.dir}/autogen-build.xml"/>
	<!-- Give user a chance to override without editing this file 
       (and without typing -D each time it compiles it -->
	<property file="${home}/.ant.properties"/>
	<property file="${user.home}/.ant.properties"/>

	<!-- =================================================================== -->
	<!-- Clean Target                                                        -->
	<!-- =================================================================== -->
	<target name="clean" description="Removes all build and deploy output.">
		<echo message="...........Cleaning project directories..........."/>
		<delete dir="${build.dir}"/>
		<delete dir="${build.tmpgen.dir}"/>
	</target>

	<!-- =================================================================== -->
	<!-- Check Options Target                                                -->
	<!-- =================================================================== -->
	<target name="checkoptions" depends="autogen-build" description="Performs pre-processing checks for environment."/>

	<!-- =================================================================== -->
	<!-- Auto gen build Target                                                -->
	<!-- =================================================================== -->
	<target name="autogen-build" description="Generates the part of the build based on the sitemap.xml file">
           <style style="${src.xml.dir}/sitemap-build.xsl" in="${src.xml.dir}/sitemap.xml" out="${autogen.build.web}"/> 
	</target>

	<!-- =================================================================== -->
	<!-- Validate XML Target                                                -->
	<!-- =================================================================== -->
	<target name="validate-xml" description="Performs validation of all XML files">
	    <xmlvalidate failonerror="no" lenient="yes" warn="yes">
        <fileset dir="${src.xml.dir}" includes="**/*.xml"/>  
    </xmlvalidate>
	</target>

	<!-- =================================================================== -->
	<!-- Deploys the web site                                                -->
	<!-- =================================================================== -->
    <target name="deploy" depends="checkoptions" description="Deploys the docs to the deploy.dir location">
      <copy todir="${deploy.dir}">
	<fileset dir="${build.web.dir}"/>
       </copy>
    </target>

	<!-- =================================================================== -->
	<!-- Creates the web site                                                -->
	<!-- =================================================================== -->
	<target name="web" depends="checkoptions" description="Creates all HTML by calling web-xyz targets.">
		<mkdir dir="${build.web.dir}"/>
		<ant antfile="${autogen.build.web}" target="web"/>
		<antcall target="copy-files"/>
	</target>
	
	<target name="copy-files">
		<copy todir="${build.web.dir}/images">
			<fileset dir="${src.images.dir}"/>
		</copy>
		<copy todir="${build.web.dir}/js">
			<fileset dir="${src.js.dir}"/>
		</copy>
		<copy todir="${build.web.dir}/css">
			<fileset dir="${src.css.dir}"/>
		</copy>
	</target>

	<!-- Creates the About section of the web site                         -->
	<target name="web-about" depends="checkoptions" description="Creates the 'About' section of the site.">
		<!-- style style="${src.xml.dir}/globalmenu.xsl" in="${src.xml.dir}/globalmenu.xml" out="${build.web.dir}/js/ca.js"/ -->
		<style force="yes" style="${src.xml.dir}/about/about.xsl" in="${src.xml.dir}/about/about.xml" out="${build.web.dir}/about/about.html"/>
		<style force="yes" style="${src.xml.dir}/about/beliefs.xsl" in="${src.xml.dir}/about/beliefs.xml" out="${build.web.dir}/about/beliefs.html"/>
		<style force="yes" style="${src.xml.dir}/about/history.xsl" in="${src.xml.dir}/about/history.xml" out="${build.web.dir}/about/history.html"/>
		<style force="yes" style="${src.xml.dir}/about/vision.xsl" in="${src.xml.dir}/about/vision.xml" out="${build.web.dir}/about/vision.html"/>
		<!-- style force="yes" style="${src.xml.dir}/about/staff.xsl" in="${src.xml.dir}/about/staff.xml" out="${build.web.dir}/about/staff.html"/ -->
		<!-- style style="${src.xml.dir}/about/staff-detail.xsl" in="${src.xml.dir}/about/staff.xml" out="${build.web.dir}/about/staff-detail.html"/ -->
		<style force="yes" style="${src.xml.dir}/staff/allen.xsl" in="${src.xml.dir}/staff/allen.xml" out="${build.web.dir}/staff/allen.html"/>
		<style force="yes" style="${src.xml.dir}/about/contact.xsl" in="${src.xml.dir}/about/contact.xml" out="${build.web.dir}/about/contact.html"/>
	</target>
	<!-- Creates the Calendar/Events section of the web site                         -->
	<target name="web-calendar" depends="checkoptions" description="Creates the Calendar' section of the site.">
		<style force="yes" style="${src.xml.dir}/calendar/schedule.xsl" in="${src.xml.dir}/calendar/schedule.xml" out="${build.web.dir}/calendar/schedule.html"/>
		<style force="yes" style="${src.xml.dir}/calendar/calendar.xsl" in="${src.xml.dir}/calendar/calendar.xml" out="${build.web.dir}/calendar/calendar.html"/>
         </target>

        <!-- Creates the Tape/RealAudio section of the web site                         -->
	<target name="web-messages" depends="checkoptions" description="Creates the tape and RealAudio section of the site">
		<style style="${src.xml.dir}/msgs/msgs-Sunday-cur.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsSundayCur.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Midweek-cur.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsMidweekCur.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Audio-BookStudies.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioBookStudies.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Audio-Overview.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioOverview.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Audio-TopicalSeries.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioTopicalSeries.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Audio-InDepth.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioInDepth.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Audio-Misc.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsAudioMisc.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Audio-categories.xsl" force="yes" in="${src.xml.dir}/msgs/msgs-categories.xml" out="${build.web.dir}/msgs/msgsAudioArchive.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Tapes-Overview.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesOverview.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Tapes-TopicalSeries.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesTopicalSeries.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Tapes-BookStudies.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesBookStudies.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Tapes-InDepth.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesInDepth.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Tapes-Misc.xsl" force="yes" in="${src.xml.dir}/msgs/msgs.xml" out="${build.web.dir}/msgs/msgsTapesMisc.html"/>
		<style style="${src.xml.dir}/msgs/msgs-Tapes-categories.xsl" force="yes" in="${src.xml.dir}/msgs/msgs-categories.xml" out="${build.web.dir}/msgs/msgsTapeArchive.html"/>
         </target>

        <!-- Creates the Ministry section of the web site                         -->
	<target name="web-ministries" depends="checkoptions" description="Creates the ministry section of the site">
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/children.xml" out="${build.web.dir}/ministries/children.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/singles.xml" out="${build.web.dir}/ministries/singles.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/frontline.xml" out="${build.web.dir}/ministries/frontline.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/home.xml" out="${build.web.dir}/ministries/home.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/men.xml" out="${build.web.dir}/ministries/men.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/women.xml" out="${build.web.dir}/ministries/women.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/womenheart.xml" out="${build.web.dir}/ministries/womenheart.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/womenstudy.xml" out="${build.web.dir}/ministries/womenstudy.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/womenhelp.xml" out="${build.web.dir}/ministries/womenhelp.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/worship.xml" out="${build.web.dir}/ministries/worship.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/youth.xml" out="${build.web.dir}/ministries/youth.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/dinner.xml" out="${build.web.dir}/ministries/dinner.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/media.xml" out="${build.web.dir}/ministries/media.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/greet.xml" out="${build.web.dir}/ministries/greet.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/meals.xml" out="${build.web.dir}/ministries/meals.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/newbelievers.xml" out="${build.web.dir}/ministries/newbelievers.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/prayer.xml" out="${build.web.dir}/ministries/prayer.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/prison.xml" out="${build.web.dir}/ministries/prison.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/sound.xml" out="${build.web.dir}/ministries/sound.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/usher.xml" out="${build.web.dir}/ministries/usher.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/youthcrisis.xml" out="${build.web.dir}/ministries/youthcrisis.html"/> 
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/internet.xml" out="${build.web.dir}/ministries/internet.html"/>          
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/coffee.xml" out="${build.web.dir}/ministries/coffee.html"/>          
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/menaccount.xml" out="${build.web.dir}/ministries/menaccount.html"/>          
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/newlife.xml" out="${build.web.dir}/ministries/newlife.html"/>          
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/overhead.xml" out="${build.web.dir}/ministries/overhead.html"/>          
                <style force="yes" style="${src.xml.dir}/ministries/ministry-home.xsl" in="${src.xml.dir}/ministries/worshipcommunity.xml" out="${build.web.dir}/ministries/worshipcommunity.html"/>          
        </target>

        <!-- Creates the Homepage section of the web site                         -->
	<target name="web-homepage" depends="checkoptions" description="Creates the homepage section of the site">
                <style force="yes" style="${src.xml.dir}/homepage/home.xsl" in="${src.xml.dir}/homepage/home.xml" out="${build.web.dir}/homepage/index.html"/> 
                <style force="yes" style="${src.xml.dir}/homepage/index.xsl" in="${src.xml.dir}/homepage/index.xml" out="${build.web.dir}/index.html"/> 
        </target>

        <!-- Creates the Articles section of the web site                         -->
	<target name="web-articles" depends="checkoptions" description="Creates the global articles for the site">
                <style force="yes" style="articles.xsl" basedir="${src.xml.dir}/articles" destdir="${build.web.dir}/articles" includes="**/*.xml"/> 
        </target>

        <!-- Creates the News section of the web site                         -->
	<target name="web-news" depends="checkoptions" description="Creates the global news items for the site">
                <style force="yes" style="news.xsl" basedir="${src.xml.dir}/news" destdir="${build.web.dir}/news" includes="**/*.xml"/> 
        </target>

        <!-- Creates the Media section of the web site                         -->
	<target name="web-media" depends="checkoptions" description="Creates the media section of the site">
                <style force="yes" style="${src.xml.dir}/media/live.xsl" in="${src.xml.dir}/media/live.xml" out="${build.web.dir}/media/live.html"/> 
                <style force="yes" style="${src.xml.dir}/media/viewlive.xsl" in="${src.xml.dir}/media/viewlive.xml" out="${build.web.dir}/media/viewlive.html"/> 
                <style force="yes" style="${src.xml.dir}/media/radiotv.xsl" in="${src.xml.dir}/media/radiotv.xml" out="${build.web.dir}/media/radiotv.html"/> 
                <style force="yes" style="${src.xml.dir}/media/continuum.xsl" in="${src.xml.dir}/media/continuum.xml" out="${build.web.dir}/continuum.html"/> <!-- redirect for older pages -->
        </target>

        <!-- Creates the staff section of the web site                         -->
	<target name="web-staff" depends="checkoptions" description="Creates the staff section of the site">
                <style force="yes" style="${src.xml.dir}/staff/gen-staff.xsl" in="${src.xml.dir}/staff/servants.xml" out="${build.tmpgen.dir}/_staff.xml"/> 
                <style force="yes" style="${src.xml.dir}/staff/staff.xsl" in="${build.tmpgen.dir}/_staff.xml" out="${build.web.dir}/about/staff.html"/> 
	</target>
</project>
